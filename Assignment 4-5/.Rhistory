## Join data and arrange by date
rates <- arrange(full_join(x=FEDFUNDS, y=BAA), date)
## Omit na rows
rates <- na.omit(rates)
## Filter for observations after March 1963
rates <- filter(rates, date>="1963-03-01")
## Melt
rates.melt <- melt(rates,
id="date",
measure.vars = c("FEDFUNDS", "BAA"),
variable.name = "Measurement",
value.name = "Rate")
## Plot
ggplot(rates.melt, aes(x=date, y=Rate, color=Measurement)) +
geom_line(size=1) +
theme_bw()
library(reshape2)
rates.melt <- melt(rates,
id="date",
measure.vars = c("FEDFUNDS", "BAA"),
variable.name = "Measurement",
value.name = "Rate")
ggplot(rates.melt, aes(x=date, y=Rate, color=Measurement)) +
geom_line(size=1) +
theme_bw()
ggplot(rates.melt, aes(x=date, y=Rate, color=Measurement)) +
geom_line(size=1) +
scale_x_continuous(breaks=c(1970,1980,1990,2000,2010,2020))
theme_bw()
ggplot(rates.melt, aes(x=date, y=Rate, color=Measurement)) +
geom_line(size=1) +
scale_x_continuous(breaks=c(1970,1980,1990,2000,2010,2020)) +
theme_bw()
ggplot(rates.melt, aes(x=date, y=Rate, color=Measurement)) +
geom_line(size=1) +
#  scale_x_continuous(breaks=c(1970,1980,1990,2000,2010,2020)) +
theme_bw()
ggplot(rates.melt, aes(x=date, y=Rate, color=Measurement)) +
geom_line(size=1) +
scale_x_continuous(breaks=c(1970,1980,1990,2000,2010,2020)) +
theme_bw()
ggplot(rates.melt, aes(x=date, y=Rate, color=Measurement)) +
geom_line(size=1) +
scale_x_date(breaks=c(1970,1980,1990,2000,2010,2020)) +
theme_bw()
ggplot(rates.melt, aes(x=date, y=Rate, color=Measurement)) +
geom_line(size=1) +
#  scale_x_date(breaks=c(1970,1980,1990,2000,2010,2020)) +
theme_bw()
ggplot(rates.melt, aes(x=date, y=Rate, color=Measurement)) +
geom_line(size=1) +
scale_x_date() +
theme_bw()
ggplot(rates.melt, aes(x=date, y=Rate, color=Measurement)) +
geom_line(size=1) +
#  scale_x_date() +
theme_bw()
ggplot(rates.melt, aes(x=date, y=Rate, color=Measurement)) +
geom_line(size=1) +
scale_x_date() +
theme_bw()
ggplot(rates.melt, aes(x=date, y=Rate, color=Measurement)) +
geom_line(size=1) +
scale_x_date(pretty_breaks(n=5)) +
theme_bw()
ggplot(rates.melt, aes(x=date, y=Rate, color=Measurement)) +
geom_line(size=1) +
scale_x_date(c("1980", "2000")) +
theme_bw()
ggplot(rates.melt, aes(x=date, y=Rate, color=Measurement)) +
geom_line(size=1) +
scale_x_date(breaks=c("1980", "2000")) +
theme_bw()
ggplot(rates.melt, aes(x=date, y=Rate, color=Measurement)) +
geom_line(size=1) +
#  scale_x_date(breaks=c("1980", "2000")) +
theme_bw()
rm(list = ls())
dev.off()
BAA  <- get_fred_series("BAA", series_name="BAA")
FEDFUNDS  <- get_fred_series("FEDFUNDS", series_name="FEDFUNDS")
rates <- arrange(full_join(x=FEDFUNDS, y=BAA), date)
rates <- na.omit(rates)
rates <- filter(rates, date>="1963-03-01")
View(rates)
rates.melt <- melt(rates,
id="date",
measure.vars = c("FEDFUNDS", "BAA"),
variable.name = "Measurement",
value.name = "Rate")
ggplot(rates.melt, aes(x=date, y=Rate, color=Measurement)) +
geom_line(size=1) +
#  scale_x_date(breaks=c("1980", "2000")) +
theme_bw()
adf.test(rates$BAA)
adf.test(rates$BAA)[1]
adf.test(rates$BAA, output=FALSE)[1]
class(adf.test(rates$BAA, output=FALSE)[1])
adf.test(rates$BAA, output=FALSE)[1][1]
adf.test(rates$BAA, output=FALSE)
adf.test(rates$BAA, output=FALSE)[1]
adf.test(rates$BAA, output=FALSE)[3]
adf.test(rates$BAA)
as.data.frame(adf.test(rates$BAA))
test <- adf.test(rates$BAA)
save(rates.melt, file="rates.melt.Rdata")
library(XLConnect)
flowsData <- readWorksheetFromFile("PS4_Data.xlsx",
sheet="Sheet1",
startRow=1,
startCol=1)
flowsData.melt <- melt(flowsData,
id="Year",
measure.vars=c("Internal_Funds_FI","Net_Increase_Liabilities_FI"),
variable.name = "Flow_Type",
value.name = "Flow")
save(flowsData.melt, file="flowsData.melt.Rdata")
adfTest <- adf.test(rates$BAA)
save(adfTest, file="adfTest.Rdata")
adfTest <- adf.test(rates$BAA, ourput=FALSE)
save(adfTest, file="adfTest.Rdata")
adfTest <- adf.test(rates$BAA, output=FALSE)
save(adfTest, file="adfTest.Rdata")
knitr::opts_chunk$set(echo = FALSE)
library(knitr)
library(kableExtra)
kbl(adfTest[1],adfTest[2],adfTest[3])
library(knitr)
library(kableExtra)
kbl(adfTest[1])
library(knitr)
library(kableExtra)
kbl(adfTest[1],
digits=2)
library(knitr)
library(kableExtra)
kbl(cbind(adfTest[1],adfTest[2]),
digits=2)
library(knitr)
library(kableExtra)
kbl(adfTest[1],
digits=2)
library(knitr)
library(kableExtra)
kbl(as.data.frame(adfTest[1]),
digits=2)
as.data.frame(adfTest)
cbind(as.data.frame(adfTest)[,1:3],
as.data.frame(adfTest)[,5:6],
as.data.frame(adfTest)[,8:9])
adf.test(rates$BAA)
library(knitr)
library(kableExtra)
adfTest.df <- cbind(as.data.frame(adfTest)[,1:3],
as.data.frame(adfTest)[,5:6],
as.data.frame(adfTest)[,8:9])
colnames(adfTest.df) <- c("Lag", "ADF", "p Value", "ADF", "p Value", "ADF", "p Value")
kbl(as.data.frame(adfTest[1]),
digits=2) %>%
add_header_above(c(" "=1, "No Drift & No Trend"=2, "Drift & No Trend"=2, "Drift & Trend"=2))
library(knitr)
library(kableExtra)
adfTest.df <- cbind(as.data.frame(adfTest)[,1:3],
as.data.frame(adfTest)[,5:6],
as.data.frame(adfTest)[,8:9])
colnames(adfTest.df) <- c("Lag", "ADF", "p Value", "ADF", "p Value", "ADF", "p Value")
kbl(adfTest.df,
digits=2) %>%
add_header_above(c(" "=1, "No Drift & No Trend"=2, "Drift & No Trend"=2, "Drift & Trend"=2))
adfTest.BAA <- as.data.frame(adf.test(rates$BAA, output=FALSE))
adfTest.FEDFUNDS <- as.data.frame(adf.test(rates$FEDFUNDS, output=FALSE))
adfTest.df <- cbind(adfTest.BAA[,1:3],
adfTest.BAA[,5:6],
adfTest.BAA[,8:9],
adfTest.FEDFUNDS[,2:3],
adfTest.FEDFUNDS[,5:6],
adfTest.FEDFUNDS[,8:9])
adfTest.df
colnames(adfTest.df) <- c("Lag", "ADF", "p Value", "ADF", "p Value", "ADF", "p Value",
"ADF", "p Value", "ADF", "p Value", "ADF", "p Value")
adfTest.df
save(adfTest.df, file="adfTest.Rdata")
load("flowsData.melt.Rdata")
load("rates.melt.Rdata")
load("adfTest.df.Rdata")
save(adfTest.df, file="adfTest.Rdata")
save(adfTest.df, file="adfTest.df.Rdata")
load("flowsData.melt.Rdata")
load("rates.melt.Rdata")
load("adfTest.df.Rdata")
library(knitr)
library(kableExtra)
kbl(adfTest.df,
digits=2,
caption = "Augmented Dicky-Fuller Test on Federal Funds Rate",
booktabs = T) %>%
add_header_above(c(" "=1, "No Drift & No Trend"=2, "Drift & No Trend"=2, "Drift & Trend"=2,
"No Drift & No Trend"=2, "Drift & No Trend"=2, "Drift & Trend"=2)) %>%
add_header_above(c(" "=1, "BAA Rate"=6, "Federal Funds Rate"=6)) %>%
kable_styling(position = "center", latex_options="scale_down")
View(rates)
mutate(rates, dBAA = diff(BAA))
diff(BAA)
diff(rates$BAA)
c(0,diff(rates$BAA))
rates <- mutate(rates, dBAA = c(0,diff(BAA)))
rates <- mutate(rates, dBAA = c(0,diff(BAA)), dFEDFUNDS = c(0,diff(FEDFUNDS)))
View(rates)
drates.melt <- melt(rates,
id="date",
measure.vars = c("dFEDFUNDS", "dBAA"),
variable.name = "Measurement",
value.name = "Rate")
View(drates.melt)
rates[2:692]
rates[2:692,]
drates.melt <- melt(rates[2:692,],
id="date",
measure.vars = c("dFEDFUNDS", "dBAA"),
variable.name = "Measurement",
value.name = "Rate")
View(drates.melt)
save(drates.melt, file="drates.melt.Rdata")
library(tidyverse)
ggplot(drates.melt, aes(x=date, y=Rate, color=Measurement)) +
geom_line(size=1) +
scale_x_date(name="Date") +
scale_color_discrete(name="Rate",
labels=c("Federal\nFunds Rate",
"BAA Rate")) +
theme_bw()
library(tidyverse)
ggplot(drates.melt, aes(x=date, y=Rate, color=Measurement)) +
geom_line(size=0.8) +
scale_x_date(name="Date") +
scale_color_discrete(name="Rate",
labels=c("Federal\nFunds Rate",
"BAA Rate")) +
theme_bw()
library(tidyverse)
ggplot(drates.melt, aes(x=date, y=Rate, color=Measurement)) +
geom_line(size=0.5) +
scale_x_date(name="Date") +
scale_color_discrete(name="Rate",
labels=c("Federal\nFunds Rate",
"BAA Rate")) +
theme_bw()
adfTest.dBAA <- as.data.frame(adf.test(rates$dBAA, output=FALSE))
adfTest.dFEDFUNDS <- as.data.frame(adf.test(rates$dFEDFUNDS, output=FALSE))
adfTest.diff.df <- cbind(adfTest.dBAA[,1:3],
adfTest.dBAA[,5:6],
adfTest.dBAA[,8:9],
adfTest.dFEDFUNDS[,2:3],
adfTest.dFEDFUNDS[,5:6],
adfTest.dFEDFUNDS[,8:9])
colnames(adfTest.diff.df) <- c("Lag", "ADF", "p Value", "ADF", "p Value", "ADF", "p Value",
"ADF", "p Value", "ADF", "p Value", "ADF", "p Value")
adfTest.diff.df
save(adfTest.diff.df, file="adfTest.diff.df.Rdata")
rm(list = ls())
library(lmtest)  ## For Granger causality
library(quantmod) ## To fetch FRED series
install.packages("quantmod")
install.packages("tseries")
library(quantmod) ## To fetch FRED series
library(tseries) ## For augmented Dickey-Fuller test
getSymbols("BAA", src="FRED")
getSymbols("FEDFUNDS", src="FRED")
baaffr <- cbind(BAA,FEDFUNDS)
View(baaffr)
baaffr$dBAA <- diff(baaffr$BAA)
baaffr$dFEDFUNDS <- diff(baaffr$FEDFUNDS)
fullperiod <- window(baaffr, start="1961-03-01", end=NULL)
fivecycles <- window(baaffr, start="1973-11-01", end="2008-02-01")
recent <- window(baaffr, start="2001-03-01", end="2008-02-01")
View(fivecycles)
View(fullperiod)
View(recent)
df0 <- data.frame(time=time(fullperiod), Year = as.numeric(as.yearmon(time(fullperiod))), fullperiod)
df1 <- data.frame(time=time(fullperiod), Year = as.numeric(as.yearmon(time(fullperiod))), fullperiod)
df2 <- subset(melt(df1, id.vars=c("time","Year"),variable.name="Rate"),substr(Rate,1,1)!="d")
View(df2)
n <- ggplot(df2, aes(time,y=value,color=Rate)) + geom_line() + ylab("Interest rate")
print(n)
View(df2)
adf.test(fullperiod$BAA,k=8)
adf.test(fullperiod$FEDFUNDS,k=8)
df3 <- subset(melt(df1, id.vars=c("time","Year"),variable.name="Rate"),substr(Rate,1,1)=="d")
View(df3)
n <- ggplot(df3, aes(time,y=value,color=Rate)) + geom_line() + ylab("Change in interest rate")
print(n)
n <- ggplot(df0, aes(x=FEDFUNDS,y=BAA,color=Year)) + geom_path() +
geom_text(aes(label=ifelse( Year %% 10 == 0 , Year,"") ), color="black", hjust=1,size=3.0 )
print(n)
n <- ggplot(df0, aes(x=dFEDFUNDS,y=dBAA,color=Year)) + geom_point()
print(n)
n <- ggplot(df0, aes(x=FEDFUNDS,y=BAA,color=Year)) + geom_path() +
geom_text(aes(label=ifelse( Year %% 10 == 0 , Year,"") ), color="black", hjust=1,size=3.0 )
print(n)
print(n)
adf.test(fivecycles$dBAA,k=8)
adf.test(fivecycles$dFEDFUNDS,k=8)
altrecent <- window(baaffr, start="2000-01-01", end="2004-06-01")
df3 <- data.frame(time=time(altrecent), altrecent)
df4 <- subset(melt(df3, id.vars="time",variable.name="Rate"),substr(Rate,1,1)!="d")
n <- ggplot(df4, aes(time,y=value,color=Rate)) + geom_line() + ylab("Interest rate")
print(n)
rm(list = ls())
dev.off()
BAA  <- get_fred_series("BAA", series_name="BAA")
FEDFUNDS  <- get_fred_series("FEDFUNDS", series_name="FEDFUNDS")
rates <- arrange(full_join(x=FEDFUNDS, y=BAA), date)
## Omit na rows
rates <- na.omit(rates)
## Filter for observations after March 1963
rates <- filter(rates, date>="1963-03-01")
## Melt
rates.melt <- melt(rates,
id="date",
measure.vars = c("FEDFUNDS", "BAA"),
variable.name = "Measurement",
value.name = "Rate")
save(rates.melt, file="rates.melt.Rdata")
#################################
##                             ##
## Augmented Dicky-Fuller Test ##
##                             ##
#################################
## Run Augmented Dicky-Fuller Test on both BAA and FEDFUNDS
adfTest.BAA <- as.data.frame(adf.test(rates$BAA, output=FALSE))
adfTest.FEDFUNDS <- as.data.frame(adf.test(rates$FEDFUNDS, output=FALSE))
## Construct a table with results
adfTest.df <- cbind(adfTest.BAA[,1:3],
adfTest.BAA[,5:6],
adfTest.BAA[,8:9],
adfTest.FEDFUNDS[,2:3],
adfTest.FEDFUNDS[,5:6],
adfTest.FEDFUNDS[,8:9])
colnames(adfTest.df) <- c("Lag", "ADF", "p Value", "ADF", "p Value", "ADF", "p Value",
"ADF", "p Value", "ADF", "p Value", "ADF", "p Value")
save(adfTest.df, file="adfTest.df.Rdata")
## Difference Variables
rates <- mutate(rates, dBAA = c(0,diff(BAA)), dFEDFUNDS = c(0,diff(FEDFUNDS)))
drates.melt <- melt(rates[2:692,],
id="date",
measure.vars = c("dFEDFUNDS", "dBAA"),
variable.name = "Measurement",
value.name = "Rate")
save(drates.melt, file="drates.melt.Rdata")
## Re-run ADF tests and construct table with results
adfTest.dBAA <- as.data.frame(adf.test(rates$dBAA, output=FALSE))
adfTest.dFEDFUNDS <- as.data.frame(adf.test(rates$dFEDFUNDS, output=FALSE))
adfTest.diff.df <- cbind(adfTest.dBAA[,1:3],
adfTest.dBAA[,5:6],
adfTest.dBAA[,8:9],
adfTest.dFEDFUNDS[,2:3],
adfTest.dFEDFUNDS[,5:6],
adfTest.dFEDFUNDS[,8:9])
colnames(adfTest.diff.df) <- c("Lag", "ADF", "p Value", "ADF", "p Value", "ADF", "p Value",
"ADF", "p Value", "ADF", "p Value", "ADF", "p Value")
save(adfTest.diff.df, file="adfTest.diff.df.Rdata")
############################
setwd("I:/Evan/Documents/Umass/Econ 753/EvanWasner_Econ753_ProblemSets/Assignment 4-5")
## Libraries
library(alfred)
library(tidyverse)
library(aTSA)
library(reshape2)
library(lmtest)  ## For Granger causality
## Clear workplace
rm(list = ls())
dev.off()
## Get data from FRED
BAA  <- get_fred_series("BAA", series_name="BAA")
FEDFUNDS  <- get_fred_series("FEDFUNDS", series_name="FEDFUNDS")
## Join data and arrange by date
rates <- arrange(full_join(x=FEDFUNDS, y=BAA), date)
## Omit na rows
rates <- na.omit(rates)
## Filter for observations after March 1963
rates <- filter(rates, date>="1963-03-01")
## Melt
rates.melt <- melt(rates,
id="date",
measure.vars = c("FEDFUNDS", "BAA"),
variable.name = "Measurement",
value.name = "Rate")
save(rates.melt, file="rates.melt.Rdata")
#################################
##                             ##
## Augmented Dicky-Fuller Test ##
##                             ##
#################################
## Run Augmented Dicky-Fuller Test on both BAA and FEDFUNDS
adfTest.BAA <- as.data.frame(adf.test(rates$BAA, output=FALSE))
adfTest.FEDFUNDS <- as.data.frame(adf.test(rates$FEDFUNDS, output=FALSE))
## Construct a table with results
adfTest.df <- cbind(adfTest.BAA[,1:3],
adfTest.BAA[,5:6],
adfTest.BAA[,8:9],
adfTest.FEDFUNDS[,2:3],
adfTest.FEDFUNDS[,5:6],
adfTest.FEDFUNDS[,8:9])
colnames(adfTest.df) <- c("Lag", "ADF", "p Value", "ADF", "p Value", "ADF", "p Value",
"ADF", "p Value", "ADF", "p Value", "ADF", "p Value")
save(adfTest.df, file="adfTest.df.Rdata")
## Difference Variables
rates <- mutate(rates, dBAA = c(0,diff(BAA)), dFEDFUNDS = c(0,diff(FEDFUNDS)))
drates.melt <- melt(rates[2:692,],
id="date",
measure.vars = c("dFEDFUNDS", "dBAA"),
variable.name = "Measurement",
value.name = "Rate")
save(drates.melt, file="drates.melt.Rdata")
## Re-run ADF tests and construct table with results
adfTest.dBAA <- as.data.frame(adf.test(rates$dBAA, output=FALSE))
adfTest.dFEDFUNDS <- as.data.frame(adf.test(rates$dFEDFUNDS, output=FALSE))
adfTest.diff.df <- cbind(adfTest.dBAA[,1:3],
adfTest.dBAA[,5:6],
adfTest.dBAA[,8:9],
adfTest.dFEDFUNDS[,2:3],
adfTest.dFEDFUNDS[,5:6],
adfTest.dFEDFUNDS[,8:9])
colnames(adfTest.diff.df) <- c("Lag", "ADF", "p Value", "ADF", "p Value", "ADF", "p Value",
"ADF", "p Value", "ADF", "p Value", "ADF", "p Value")
save(adfTest.diff.df, file="adfTest.diff.df.Rdata")
############################
##                        ##
## Granger Causality Test ##
##                        ##
############################
setwd("I:/Evan/Documents/Umass/Econ 753/EvanWasner_Econ753_ProblemSets/Assignment 4-5")
## Libraries
library(alfred)
library(tidyverse)
library(aTSA)
library(reshape2)
library(lmtest)  ## For Granger causality
## Clear workplace
rm(list = ls())
dev.off()
## Get data from FRED
BAA  <- get_fred_series("BAA", series_name="BAA")
FEDFUNDS  <- get_fred_series("FEDFUNDS", series_name="FEDFUNDS")
## Join data and arrange by date
rates <- arrange(full_join(x=FEDFUNDS, y=BAA), date)
## Omit na rows
rates <- na.omit(rates)
## Filter for observations after March 1963
rates <- filter(rates, date>="1963-03-01")
## Melt
rates.melt <- melt(rates,
id="date",
measure.vars = c("FEDFUNDS", "BAA"),
variable.name = "Measurement",
value.name = "Rate")
save(rates.melt, file="rates.melt.Rdata")
#################################
##                             ##
## Augmented Dicky-Fuller Test ##
##                             ##
#################################
## Run Augmented Dicky-Fuller Test on both BAA and FEDFUNDS
adfTest.BAA <- as.data.frame(adf.test(rates$BAA, output=FALSE))
adfTest.FEDFUNDS <- as.data.frame(adf.test(rates$FEDFUNDS, output=FALSE))
## Construct a table with results
adfTest.df <- cbind(adfTest.BAA[,1:3],
adfTest.BAA[,5:6],
adfTest.BAA[,8:9],
adfTest.FEDFUNDS[,2:3],
adfTest.FEDFUNDS[,5:6],
adfTest.FEDFUNDS[,8:9])
colnames(adfTest.df) <- c("Lag", "ADF", "p Value", "ADF", "p Value", "ADF", "p Value",
"ADF", "p Value", "ADF", "p Value", "ADF", "p Value")
save(adfTest.df, file="adfTest.df.Rdata")
## Difference Variables
rates <- mutate(rates, dBAA = c(0,diff(BAA)), dFEDFUNDS = c(0,diff(FEDFUNDS)))
drates.melt <- melt(rates[2:692,],
id="date",
measure.vars = c("dFEDFUNDS", "dBAA"),
variable.name = "Measurement",
value.name = "Rate")
save(drates.melt, file="drates.melt.Rdata")
## Re-run ADF tests and construct table with results
adfTest.dBAA <- as.data.frame(adf.test(rates$dBAA, output=FALSE))
adfTest.dFEDFUNDS <- as.data.frame(adf.test(rates$dFEDFUNDS, output=FALSE))
adfTest.diff.df <- cbind(adfTest.dBAA[,1:3],
adfTest.dBAA[,5:6],
adfTest.dBAA[,8:9],
adfTest.dFEDFUNDS[,2:3],
adfTest.dFEDFUNDS[,5:6],
adfTest.dFEDFUNDS[,8:9])
colnames(adfTest.diff.df) <- c("Lag", "ADF", "p Value", "ADF", "p Value", "ADF", "p Value",
"ADF", "p Value", "ADF", "p Value", "ADF", "p Value")
save(adfTest.diff.df, file="adfTest.diff.df.Rdata")
rm(list = ls())
library(aTSA)
BAA  <- get_fred_series("BAA", series_name="BAA")
FEDFUNDS  <- get_fred_series("FEDFUNDS", series_name="FEDFUNDS")
## Join data and arrange by date
rates <- arrange(full_join(x=FEDFUNDS, y=BAA), date)
## Omit na rows
rates <- na.omit(rates)
## Filter for observations after March 1963
rates <- filter(rates, date>="1963-03-01")
## Melt
rates.melt <- melt(rates,
id="date",
measure.vars = c("FEDFUNDS", "BAA"),
variable.name = "Measurement",
value.name = "Rate")
adfTest.BAA <- as.data.frame(adf.test(rates$BAA, output=FALSE))
